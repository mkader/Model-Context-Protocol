## Building Weather MCP Server: A Beginners Tutorial

* AI assistant to access real-time data? MCP servers make this possible and they're simple to build and use!
* Example : Using the Playwright MCP to go to a website and generate test ideas and then generate actual Playwright tests after first interacting with the site.
* MCP gives the AI agents tools to be able to do things such as connect to a browser or as in the GitHub MCP, create pull requests etc.

* Create a weather server that connects AI agents like GitHub Copilot to live weather data.
* Using TypeScript for this demo but you can build MCP servers in other languages

* Learn 
  1. How to build an MCP server from scratch using the TypeScript SDK
  1. Connect it to a real weather API
  1. Integrate it with VS Code and GitHub Copilot
  1. Test and debug your server

* What is an MCP Server?
  1. MCP servers are bridges that connect AI agents to external tools and data sources. Think of them as translators that help AI understand and interact with real-world applications.
  1. The Problem: When you ask GitHub Copilot for weather information in VS Code, you'll get a response like this:
    1. "I don't have access to real-time weather data or weather APIs through the available tools in this coding environment."
  1. The Solution: MCP servers provide the missing link, giving AI agents the tools they need to access live data and perform real actions.
    1. Our weather server will act as a tool that any MCP-compatible AI can call to get current weather information for any city worldwide.
 
### Step 1: Project Setup
  1. Create a new directory (mcp-weather-server) and initialize it with npm
  ```
  npm init -y
  ```   
 
  package.json
  ```
  {
    "name": "mcp-weather-server",
    "version": "1.0.0",
    "description": "",
    "main": "index.js",
    "scripts": {
      "test": "echo \"Error: no test specified\" && exit 1"
    },
    "keywords": [],
    "author": "",
    "license": "ISC",
    "type": "commonjs"
  }
  ```
  3. Modify package.json to enable ES modules by adding the type field. Why ES modules? The MCP SDK uses modern JS modules, so we need to enable them in our project.
      ```
      {
        "name": "mcp-weather-server",
        "version": "1.0.0",
        "type": "module",
        "scripts": {
          "test": "echo \"Error: no test specified\" && exit 1"
        }
      }
      ```

### Step 2: Install Dependencies
  1. Our MCP server needs two key libraries:
  2. Install the MCP SDK. It provides everything needed to build MCP servers
  ```
  npm install @modelcontextprotocol/sdk
  ```
  3. Install Zod for Data Validation. It ensures our server receives valid data from AI agents:
  ```
  npm install zod
  ```
  4. package.json with dependencies
  ```
  {
    "name": "mcp-weather-server",
    "version": "1.0.0",
    "type": "module",
    "scripts": {
      "test": "echo \"Error: no test specified\" && exit 1"
    },
    "dependencies": {
      "@modelcontextprotocol/sdk": "^1.20.1",
      "zod": "^3.25.76"
    }
  }  
  ```

### Step 3: Building the Basic Server
  * Create the Main TypeScript File (main.ts)
  ```
  // 1. Add the Required Imports, https://zod.dev/
  import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";
  import { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js';
  import { z } from "zod";

  // 2. Create the Server Instance. The server manages all communication using the MCP protocol between clients (like VS Code) and your tools.
  const server = new McpServer({
    name: "Weather Server",
    version: "1.0.0"
  });

  // 3. Define Your First Tool. Tools are functions that AI agents can call. Let's create a get-weather tool:
  server.tool(
    // 3.1 Tool ID: 'get-weather' - Unique identifier
    'get-weather',
  
    // 3.2 Description: Helps AI agents understand what this tool does
    'Tool to get the weather of a city',  

    // 3.3 Schema: Defines parameters (city must be a string)
    {  
      city: z.string().describe("The name of the city to get the weather for")  
    }, 

    // 3.4 Function: The actual code that runs when called
    async ({ city }) => {
      // For now, return a simple static response
      return {
        content: [{
          type: "text",
          text: `The weather in ${city} is sunny`
        }]
      };
    }
  );
  /*
  How it works 3.:
    AI agent sees: "Tool to get the weather of a city"
    AI agent calls it with: { city: "Paris" }
    Zod validates the input
    Function returns: "The weather in Paris is sunny"
  */

  // 4. Finally Set Up our server communicates with AI clients:
  const transport = new StdioServerTransport();
  server.connect(transport);
  /*
  What's happening here 4.:
    StdioServerTransport uses your terminal's input/output for communication
    Perfect for local development
    The server reads requests from stdin and writes responses to stdout
    MCP protocol handles all the message formatting automatically
  */    
  ```
  * You've built your first MCP server. Let's test it!

### Step 4: Testing with MCP Inspector
  1. Before adding real weather data, let's test our server using the MCP Inspector, a web-based debugging tool for MCP servers.
  2. Launch the Inspector. Run this command to open the MCP Inspector for your server
  ```
  npx -y @modelcontextprotocol/inspector npx -y tsx main.ts
  ```
  3. After running the command, you'll see terminal output with:
      1. A localhost URL (like http://127.0.0.1:6274)
      1. A unique session token
      1. A direct link with the token pre-filled
      1. <img width="1027" height="248" alt="image" src="https://github.com/user-attachments/assets/8a9573f9-6022-4a9a-85cd-0438f6efe34f" />
      1. <img width="812" height="750" alt="image" src="https://github.com/user-attachments/assets/e36496d8-5c8e-44a9-8e0f-12202bf45434" />
  4. Connect and Test
      1. Connect: Click the "Connect" button in the Inspector
      1. Navigate: Click "Tools"->"List Tools" in the top navigation
      1. Select: Choose your get-weather tool
      1. Test: Enter a city name ("Paris") and click "Run Tool"
      1. You should see the response: "The weather in Paris is sunny"
      1. <img width="798" height="490" alt="image" src="https://github.com/user-attachments/assets/564c7008-9539-4c32-ad3d-8d5d4848abf1" />
  5. Perfect! Your MCP server is working. Now let's make it actually useful.

### Step 5: Adding Real Weather Data
  1. Integrate with Open-Meteo (https://open-meteo.com/), a free weather API that requires no API key.
  1. To get weather data, we need a two-step process:
      1. Convert city name → coordinates (using the Geocoding API)
      1. Get weather using coordinates (using the Weather API)
  1. Update Your Tool Function (main.ts), replace "server.tool" function with this enhanced version:
  ```
  server.tool(
    'get-weather',
    'Tool to get the weather of a city',
    {
      city: z.string().describe("The name of the city to get the weather for")
    },
    async ({ city }) => {
      try {
        // Step 1: Get coordinates for the city
        const geoResponse = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${city}&count=1&language=en&format=json`);
        const geoData = await geoResponse.json();
  
        // Handle city not found
        if (!geoData.results || geoData.results.length === 0) {
          return {
            content: [{
              type: "text",
              text: `Sorry, I couldn't find a city named "${city}". Please check the spelling and try again.`
            }]
          };
        }
  
        // Step 2: Get weather data using coordinates
        const { latitude, longitude } = geoData.results[0];
        const weatherResponse = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code&hourly=temperature_2m,precipitation&forecast_days=1`);
        const weatherData = await weatherResponse.json();
  
        // Return the complete weather data as JSON
        return {
          content: [{
            type: "text",
            text: JSON.stringify(weatherData, null, 2)
          }]
        };
      } catch (error) {
        return {
          content: [{
            type: "text",
            text: `Error fetching weather data: ${error.message}`
          }]
        };
      }
    }
  );
  ```
  1. Test the Real Data
      1. Restart your MCP Inspector (Ctrl+C, then re-run the command)
      1. Reconnect in the web interface
      1. Test with a real city like "Paris", "Tokyo" or "New York"
      1. You should now see actual weather data instead of "sunny"!
      2. <img width="943" height="805" alt="image" src="https://github.com/user-attachments/assets/1afd7336-b36f-4dd2-b4bd-1719233c2fea" />

### Step 6: Integration with VS Code and GitHub Copilot
  1. Now let's connect your weather server to VS Code so you can use it with GitHub Copilot!
      1. Register the Server
      1. Open Command Palette: Cmd/Ctrl + Shift + P
      1. Type: MCP: Add Server
      1. Choose: "Local server using stdio"
      2. <img width="986" height="303" alt="image" src="https://github.com/user-attachments/assets/058da0bd-4553-4894-9026-ce4c43da49e7" />
      1. Enter Command: npx -y tsx main.ts
      1. Name: my-weather-server
      1. Setup Type: Local setup
      1. This creates a .vscode/mcp.json file in your project:
      ```
      {
      	"servers": {
      		"my-mcp-server-8c35603c": {
      			"type": "stdio",
      			"command": "npx",
      			"args": [
      				"-y",
      				"tsx",
      				"main.ts"
      			]
      		}
      	},
      	"inputs": []
      }
      ```
  2. Start and Test
      1. Start the server: Click the "Start" button next to your server name in the MCP panel
      2. <img width="500" height="181" alt="image" src="https://github.com/user-attachments/assets/d1e67172-8640-4115-841e-0b90cece4088" />
      1. Verify: You should see "Running" status
      1. Switch to Agent Mode: Click the Copilot sidebar → "Agent Mode"
      1. Ask: "What's the weather like in paris?"
      2. <img width="413" height="563" alt="image" src="https://github.com/user-attachments/assets/2072a2ac-33d9-48d0-835b-0581f8e341ee" />
      1. GitHub Copilot will ask permission to use your weather tool, click "Continue" to proceed.
      1. Expected Result: Instead of raw JSON, you'll get a beautifully formatted weather report like this:
      1. <img width="397" height="896" alt="image" src="https://github.com/user-attachments/assets/630b0104-b497-435e-a339-faecb6a765ee" />
  3. Perfect! The AI transforms your raw weather data into a beautiful, human-readable format automatically.

### Why This is Powerful
  1. Your weather server demonstrates the true power of MCP:
  1. AI Does the Heavy Lifting
      1. You provide raw data, AI creates beautiful presentations
      1. No need to format responses, the AI handles user experience
  1. Universal Compatibility
      1. Works with any MCP-compatible tool (VS Code, Claude, etc.)
      1. Write once, use everywhere
  1. Real-time Integration
      1. Always current data, no caching issues
      1. Works seamlessly within your development environment
  1. Easy to Extend
      1. Add weather alerts, forecasts, or air quality data
      1. Build additional tools in the same server
      ```
      server.tool('get-forecast', 'Get 7-day weather forecast', ...)
      server.tool('get-alerts', 'Get severe weather warnings', ...)
      server.tool('get-air-quality', 'Get air pollution data', ...)
      ```
  1. Sharing Your Server
      1. Publish to NPM: Make it available for others to use

### Key Takeaways:
  1. Simplicity: MCP servers are much easier to build than they appear
  1. Power: Real data makes AI interactions dramatically more valuable
  1. Flexibility: The same server works across multiple AI platforms
  1. Future-ready: You're building the infrastructure for next-gen AI

### What's Next? Now you can connect AI to databases, APIs, file systems, and any service you can imagine.
