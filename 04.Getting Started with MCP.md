### Basic MCP Server Structure

* An MCP server typically includes:
    - **Server Configuration**: Setup port, authentication, and other settings
    - **Resources**: Data and context made available to LLMs
    - **Tools**: Functionality that models can invoke
    - **Prompts**: Templates for generating or structuring text

* Here's a simplified example in TypeScript:

```typescript
import { McpServer, ResourceTemplate } from "@modelcontextprotocol/sdk/server/mcp.js";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
import { z } from "zod";

// Create an MCP server
const server = new McpServer({
  name: "Demo",
  version: "1.0.0"
});

// Add an addition tool
server.tool("add",
  { a: z.number(), b: z.number() },
  async ({ a, b }) => ({
    content: [{ type: "text", text: String(a + b) }]
  })
);

// Add a dynamic greeting resource
server.resource(
  "file",
  // The 'list' parameter controls how the resource lists available files. Setting it to undefined disables listing for this resource.
  new ResourceTemplate("file://{path}", { list: undefined }),
  async (uri, { path }) => ({
    contents: [{
      uri: uri.href,
      text: `File, ${path}!`
    }]
  })
);

// Add a file resource that reads the file contents
server.resource(
  "file",
  new ResourceTemplate("file://{path}", { list: undefined }),
  async (uri, { path }) => {
    let text;
    try {
      text = await fs.readFile(path, "utf8");
    } catch (err) {
      text = `Error reading file: ${err.message}`;
    }
    return {
      contents: [{
        uri: uri.href,
        text
      }]
    };
  }
);

server.prompt(
  "review-code",
  { code: z.string() },
  ({ code }) => ({
    messages: [{
      role: "user",
      content: {
        type: "text",
        text: `Please review this code:\n\n${code}`
      }
    }]
  })
);

// Start receiving messages on stdin and sending messages on stdout
const transport = new StdioServerTransport();
await server.connect(transport);
```

* In the preceding code we:
    - Import the necessary classes from the MCP TypeScript SDK.
    - Create and configure a new MCP server instance.
    - Register a custom tool (`calculator`) with a handler function.
    - Start the server to listen for incoming MCP requests.
 
### Testing and Debugging

* MCP provides tools to help you test and debug your servers:
    - **Inspector tool**, this graphical interface allows you to connect to your server and test your tools, prompts and resources.
    - **curl**, you can also connect to your server using a command line tool like curl or other clients than can create and run HTTP commands.

* Using [MCP Inspector](https://github.com/modelcontextprotocol/inspector) - is a visual testing tool that helps you:
    1. **Discover Server Capabilities**: Automatically detect available resources, tools, and prompts
    2. **Test Tool Execution**: Try different parameters and see responses in real-time
    3. **View Server Metadata**: Examine server info, schemas, and configurations

    ```bash
    # ex TypeScript, installing and running MCP Inspector
    npx @modelcontextprotocol/inspector node build/index.js
    ```
   * The MCP Inspector coomand will launch a local web interface in your browser.
   * Dashboard displaying your registered MCP servers, their available tools, resources, and prompts.
   * Interactively test tool execution, inspect server metadata, and view real-time responses, making it easier to validate and debug your MCP server implementations.

    <img width="1000" height="400" alt="image" src="https://github.com/user-attachments/assets/12fad6b0-cddb-4e63-8f32-eb16202ac825" />

* Local Development and testing - run MCP servers directly on your machine:
    ```bash
    # Example: Running a TypeScript MCP server locally
    npm run start
    # Server running at http://localhost:3000
    ```

### MCP server can do for example:
  - Access local files and databases
  - Connect to remote APIs
  - Perform computations
  - Integrate with other tools and services
  - Provide a user interface for interaction


In the preceding code we've:

- Defined a tool `add` that takes parameters `a` and `p`, both integers.
- Created a resource called `greeting` that takes parameter `name`.



### -7- Test the server

Start the server with the following command:

#### TypeScript

```sh
npm run build
```

#### Python

```sh
mcp run server.py
```

> To use MCP Inspector, use `mcp dev server.py` which automatically launches the Inspector and provides the required proxy session token. If using `mcp run server.py`, youâ€™ll need to manually start the Inspector and configure the connection.

#### .NET

Make sure you're in your project directory:

```sh
cd McpCalculatorServer
dotnet run
```

#### Java

```bash
./mvnw clean install -DskipTests
java -jar target/calculator-server-0.0.1-SNAPSHOT.jar
```

#### Rust

Run the following commands to format and run the server:

```sh
cargo fmt
cargo run
```

### -8- Run using the inspector

The inspector is a great tool that can start up your server and lets you interact with it so you can test that it works. Let's start it up:

> [!NOTE]
> it might look different in the "command" field as it contains the command for running a server with your specific runtime/

#### TypeScript

```sh
npx @modelcontextprotocol/inspector node build/index.js
```

or add it to your *package.json* like so: `"inspector": "npx @modelcontextprotocol/inspector node build/index.js"` and then run `npm run inspector`

Python wraps a Node.js tool called inspector. It's possible to call said tool like so:

```sh
mcp dev server.py
```

However, it doesn't implement all the methods available on the tool so you're recommended to run the Node.js tool directly like below:

```sh
npx @modelcontextprotocol/inspector mcp run server.py
```

If you're using a tool or IDE that allows you to configure commands and arguments for running scripts, 
make sure to set `python` in the `Command` field and `server.py` as `Arguments`. This ensures the script runs correctly.

#### .NET

Make sure you're in your project directory:

```sh
cd McpCalculatorServer
npx @modelcontextprotocol/inspector dotnet run
```

#### Java

Ensure you calculator server is running
The run the inspector:

```cmd
npx @modelcontextprotocol/inspector
```

In the inspector web interface:

1. Select "SSE" as the transport type
2. Set the URL to: `http://localhost:8080/sse`
3. Click "Connect"

![Connect](/03-GettingStarted/01-first-server/assets/tool.png)

**You're now connected to the server**
**The Java server testing section is completed now**

The next section it's about interacting with the server.

You should see the following user interface:

![Connect](/03-GettingStarted/01-first-server/assets/connect.png)

1. Connect to the server by selecting the Connect button
  Once you connect to the server, you should now see the following:

  ![Connected](/03-GettingStarted/01-first-server/assets/connected.png)

1. Select "Tools" and "listTools", you should see "Add" show up, select "Add" and fill in the parameter values.

  You should see the following response, i.e a result from "add" tool:

  ![Result of running add](/03-GettingStarted/01-first-server/assets/ran-tool.png)

Congrats, you've managed to create and run your first server!

#### Rust

To run the Rust server with the MCP Inspector CLI, use the following command:

```sh
npx @modelcontextprotocol/inspector cargo run --cli --method tools/call --tool-name add --tool-arg a=1 b=2
```

### Official SDKs

MCP provides official SDKs for multiple languages:

- [C# SDK](https://github.com/modelcontextprotocol/csharp-sdk) - Maintained in collaboration with Microsoft
- [Java SDK](https://github.com/modelcontextprotocol/java-sdk) - Maintained in collaboration with Spring AI
- [TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk) - The official TypeScript implementation
- [Python SDK](https://github.com/modelcontextprotocol/python-sdk) - The official Python implementation
- [Kotlin SDK](https://github.com/modelcontextprotocol/kotlin-sdk) - The official Kotlin implementation
- [Swift SDK](https://github.com/modelcontextprotocol/swift-sdk) - Maintained in collaboration with Loopwork AI
- [Rust SDK](https://github.com/modelcontextprotocol/rust-sdk) - The official Rust implementation

## Key Takeaways

- Setting up an MCP development environment is straightforward with language-specific SDKs
- Building MCP servers involves creating and registering tools with clear schemas
- Testing and debugging are essential for reliable MCP implementations

## Samples

- [Java Calculator](../samples/java/calculator/README.md)
- [.Net Calculator](../samples/csharp/)
- [JavaScript Calculator](../samples/javascript/README.md)
- [TypeScript Calculator](../samples/typescript/README.md)
- [Python Calculator](../samples/python/)
- [Rust Calculator](../samples/rust/)

## Assignment

Create a simple MCP server with a tool of your choice:

1. Implement the tool in your preferred language (.NET, Java, Python, TypeScript, or Rust).
2. Define input parameters and return values.
3. Run the inspector tool to ensure the server works as intended.
4. Test the implementation with various inputs.

## Solution

[Solution](./solution/README.md)

## Additional Resources

- [Build Agents using Model Context Protocol on Azure](https://learn.microsoft.com/azure/developer/ai/intro-agents-mcp)
- [Remote MCP with Azure Container Apps (Node.js/TypeScript/JavaScript)](https://learn.microsoft.com/samples/azure-samples/mcp-container-ts/mcp-container-ts/)
- [.NET OpenAI MCP Agent](https://learn.microsoft.com/samples/azure-samples/openai-mcp-agent-dotnet/openai-mcp-agent-dotnet/)

## What's next

Next: [Getting Started with MCP Clients](../02-client/README.md)
